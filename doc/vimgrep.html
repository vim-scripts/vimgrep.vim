<html>

<head>
<meta name=Generator content="Microsoft Office HTML Filter 2.0">
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=Originator content="Microsoft Word 9">
<title> </title>
<style>
<!--
 
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{
	margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
h2
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.4in;
	text-indent:-.4in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:Arial;
	font-style:italic;}
h3
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	text-indent:-.5in;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:Arial;}
h4
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.6in;
	text-indent:-.6in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Times New Roman";}
h5
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.7in;
	text-indent:-.7in;
	font-size:13.0pt;
	font-family:"Times New Roman";
	font-style:italic;}
h6
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.8in;
	text-indent:-.8in;
	font-size:11.0pt;
	font-family:"Times New Roman";}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.9in;
	text-indent:-.9in;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:1.0in;
	text-indent:-1.0in;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:1.1in;
	text-indent:-1.1in;
	font-size:11.0pt;
	font-family:Arial;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman";}
p.MsoDocumentMap, li.MsoDocumentMap, div.MsoDocumentMap
	{margin:0in;
	margin-bottom:.0001pt;
	background:navy;
	font-size:12.0pt;
	font-family:Tahoma;}
p.MsoPlainText, li.MsoPlainText, div.MsoPlainText
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Courier New";}
span.EmailStyle15
	{
	color:windowtext;}
span.EmailStyle16
	{
	color:windowtext;}
p.HeaderSep, li.HeaderSep, div.HeaderSep
	{
	margin:0in;
	margin-bottom:.0001pt;
	background:#88942C;
	font-size:10.0pt;
	font-family:"Courier New";}
p.Divider, li.Divider, div.Divider
	{
	margin:0in;
	margin-bottom:.0001pt;
	background:teal;
	font-size:10.0pt;
	font-family:"Courier New";}
p.CmdTxt, li.CmdTxt, div.CmdTxt
	{
	margin:0in;
	margin-bottom:.0001pt;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:maroon;}
p.ArgTxt, li.ArgTxt, div.ArgTxt
	{
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:#339966;}
p.DispTxt, li.DispTxt, div.DispTxt
	{
	margin-top:0in;
	margin-right:.1in;
	margin-bottom:6.0pt;
	margin-left:.1in;
	text-align:justify;
	font-size:10.0pt;
	font-family:Arial;}
p.EmphTxt, li.EmphTxt, div.EmphTxt
	{
	margin-top:0in;
	margin-right:.1in;
	margin-bottom:6.0pt;
	margin-left:.1in;
	text-align:justify;
	font-size:10.0pt;
	font-family:Arial;
	font-weight:bold;}
p.safe, li.safe, div.safe
	{
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.1in;
	margin-bottom:.0001pt;
	background:lime;
	font-size:10.0pt;
	font-family:"Courier New";
	color:#216146;}
p.SyntaxStmt, li.SyntaxStmt, div.SyntaxStmt
	{
	margin-top:12.0pt;
	margin-right:.6in;
	margin-bottom:12.0pt;
	margin-left:.6in;
	text-align:center;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:maroon;}
p.ArgSyntax, li.ArgSyntax, div.ArgSyntax
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:1.95in;
	margin-bottom:.0001pt;
	text-indent:-1.35in;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:#339966;}
p.DescTxt, li.DescTxt, div.DescTxt
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:1.95in;
	margin-bottom:.0001pt;
	text-align:center;
	text-indent:-1.35in;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:#3366FF;}
p.AssignTxt, li.AssignTxt, div.AssignTxt
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:2.6in;
	margin-bottom:.0001pt;
	text-indent:-2.0in;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:purple;}
p.CmdDesc, li.CmdDesc, div.CmdDesc
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:1.95in;
	margin-bottom:.0001pt;
	text-indent:-1.35in;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:maroon;}
p.AssignDesc, li.AssignDesc, div.AssignDesc
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:2.6in;
	margin-bottom:.0001pt;
	text-indent:-2.0in;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:teal;}
p.ArgType, li.ArgType, div.ArgType
	{
	margin-top:0in;
	margin-right:.6in;
	margin-bottom:0in;
	margin-left:2.6in;
	margin-bottom:.0001pt;
	text-indent:-2.0in;
	font-size:10.0pt;
	font-family:"Arial Black";
	color:#CC99FF;
	font-weight:bold;
	font-style:italic;}
p.CopyNPaste, li.CopyNPaste, div.CopyNPaste
	{
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Cordia New";}
p.CopyNPasteLabel, li.CopyNPasteLabel, div.CopyNPasteLabel
	{
	margin:0in;
	margin-bottom:.0001pt;
	text-indent:0in;
	font-size:10.0pt;
	font-family:"Courier New";}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
</head>

<body lang=EN-US>

<div class=Section1>

<p class=MsoNormal>&nbsp;</p>

<p class=HeaderSep>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=DispTxt>The plugin <b>vimgrep.vim</b>
implements grep type searching using native vim search capabilities only.  It allows the user to have wholly contained
file searching within Vim and no need of outside grep style search programs.  The implementation uses commands where
appropriate for ease of use and/or a function interface for scripting and
non-command line echo return.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=MsoPlainText>&nbsp;</p>

<p class=DispTxt>The nominal command and function of <b>vimgrep.vim</b> are both named <span style='
font-family:"Arial Black";color:maroon'>Vimgrep</span>. 
They have identical arguments, excepting that the command mechanism wraps
its arguments for functions in quotes, so allowances in usage must be made for
this.  It is perhaps easier to just get
used to one or the other and use it exclusively.  The more desirable of the two would then be the function.  For command line use when desiring display,
just remember to use <span style='font-family:"Arial Black";
color:maroon'>echo</span> instead of <span style='
font-family:"Arial Black";color:maroon'>call</span>.</p>

<p class=DispTxt>The syntax for the function will be given here, command syntax
is the same except as noted above.</p>

<p class=SyntaxStmt>call Vimgrep(<span style='
color:#339966'>srchpat</span>,<span style='
color:#339966'>file</span><span style='font-family:Arial;color:windowtext'>[</span>,<span style='
color:#339966'>MC</span>,<span style='color:#339966'>FNonly</span>,<span
style='color:#339966'>terse</span>,<span
style='color:#339966'>doSubs</span>,<span
style='color:#339966'>fpat</span>,<span
style='color:#339966'>mpat</span><span
style='font-family:Arial;color:windowtext'>]</span>)</p>

<p class=DispTxt>Only the first 2 arguments are required, the balance are
optional, but positionally required (i.e., to specify <span style='font-family:"Arial Black";color:#339966'>terse</span>, you must also
specify <span style='font-family:"Arial Black";
color:#339966'>MC</span> and <span style='font-family:
"Arial Black";
color:#339966'>FNonly</span>).  Let’s
take the arguments one by one.</p>

<p class=ArgSyntax>&nbsp;</p>

<p class=ArgSyntax>srchpat                  <span
style='color:#3366FF'>string or regex to search for in file(s).</span></p>

<p class=ArgSyntax>file                           <span
style='color:#3366FF'>file(s) to search. 
Can be a single file, a comma separated list, a newline separated list,
regex, or any combination.</span></p>

<p class=ArgSyntax>MC                           <span
style='color:#3366FF'>0 or 1 as Boolean for case matching.  Default is 0, that is, case matching is not
required (i.e., ignored).</span></p>

<p class=DescTxt align=left style='text-align:left'><span style='color:#339966'>FNonly</span>                    0 or 1 Boolean.  1 returns names of files containing matches
only.</p>

<p class=ArgSyntax>terse                       <span
style='color:#3366FF'>0 or 1 Boolean. 
When 1 do not return messages that identify files that are directories,
files that are empty, files that are non text, and files in which the pattern
was not found.</span></p>

<p class=ArgSyntax>doSubs                   <span
style='color:#3366FF'>0 or 1 Boolean.  1
== search in subdirectories also.</span></p>

<p class=ArgSyntax>fpat                         <span
style='color:#3366FF'>specific file patterns to search for, e.g.
‘\w*\.vim\&gt;’ or ‘\w*\.txt\&gt;’.  Use
‘’ or “” for positional placeholder.</span></p>

<p class=ArgSyntax>mpat                       <span
style='color:#3366FF'>specific file patterns to skip, e.g. ‘syntax\|lang’.</span></p>

<p class=ArgSyntax>&nbsp;</p>

<p class=ArgSyntax><span style='color:purple'>Returns</span>                  <span style='color:teal'>line
number and line text where </span>srchpat<span
style='color:teal'> was found or messages that identify result on specific
file, unless </span>terse<span
style='color:teal'> is specified, then only successful searches are
returned.  If </span>FNonly<span style='color:teal'> is
specified, only the names of files successfully searched are returned.</span></p>

<p class=ArgSyntax>&nbsp;</p>

<p class=DispTxt>You can capture the output in various ways.  The most common would be to assign the
function return within a script to a variable. 
Alternatively when <span style='font-family:
"Arial Black";
color:maroon'>echo</span>-ing the function or using the <span style='font-family:"Arial Black";color:maroon'>Vimgrep</span> command, <span
style='font-family:"Arial Black";color:maroon'>redir</span> to a
register or file could also be used, just don’t forget to <span
style='font-family:"Arial Black";color:maroon'>redir</span> <span
style='font-family:"Arial Black";color:#339966'>END</span> when
done.</p>

<p class=DispTxt>These arguments are standard in each command/function in <b>vimgrep.vim</b> as and when they apply, and
in the stated order to avoid confusion.</p>

<span style='font-size:10.0pt;font-family:Arial;'><br
clear=all style='page-break-before:always'>
</span>

<p class=DispTxt>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>There is a naming convention used in <b>vimgrep.vim</b> that generally makes it easier to tell a command from a
function.  Functions begin with alpha
and end with Vimgrep, whereas commands begin with Vimgrep and end with
alpha.  The following is a listing of
all of the public commands/functions.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<div align=center>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;'>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt><span style='font-size:14.0pt;'>Command</span></p>
  </td>
  <td width=192 valign=top style='width:2.0in;border:solid windowtext .5pt;
  border-left:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt><span style='font-size:14.0pt;'>Function</span></p>
  </td>
  <td width=134 valign=top style='width:1.4in;border:solid windowtext .5pt;
  border-left:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt><span style='font-size:14.0pt;'>Reqd
  args</span></p>
  </td>
  <td width=134 valign=top style='width:1.4in;border:solid windowtext .5pt;
  border-left:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt><span style='font-size:14.0pt;'>Optnl
  args</span></p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>Vimgrep</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>Vimgrep()</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>2</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>6</p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>VimgrepToBuf</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>ToBufVimgrep()</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>2</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>6</p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>VimgrepEdit</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>EditVimgrep()</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>2</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>6</p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>VimgrepEditDel</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>&nbsp;</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>&nbsp;</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>&nbsp;</p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>VimgrepBufs</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>BufsVimgrep()</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>1</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>1</p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>VimgrepBufsToBuf</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>BufsToBufVimgrep()</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>1</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>1</p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>VimgrepHelp</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>HelpVimgrep()</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>1</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>1</p>
  </td>
 </tr>
 <tr>
  <td width=173 valign=top style='width:1.8in;border:solid windowtext .5pt;
  border-top:none;padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>VimgrepHelpDel</p>
  </td>
  <td width=192 valign=top style='width:2.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>&nbsp;</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>&nbsp;</p>
  </td>
  <td width=134 valign=top style='width:1.4in;border-top:none;border-left:none;
  border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  padding:0in 5.75pt 0in 5.75pt'>
  <p class=CmdTxt>&nbsp;</p>
  </td>
 </tr>
</table>

</div>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>As stated before, arguments are standard, so we’ll only review
where they differ.</p>

<p class=SyntaxStmt>VimgrepEditDel</p>

<p class=DispTxt>This is a command that deletes the buffers created by <span
style='font-family:"Arial Black";color:maroon'>VimgrepEdit</span>/<span
style='font-family:"Arial Black";color:maroon'>EditVimgrep()</span>.  It takes no arguments.</p>

<p class=SyntaxStmt>VimgrepHelpDel</p>

<p class=DispTxt>This is a command that deletes the buffers created by <span
style='font-family:"Arial Black";color:maroon'>VimgrepHelp</span>/<span
style='font-family:"Arial Black";color:maroon'>HelpVimgrep()</span>.  It takes no arguments.</p>

<p class=SyntaxStmt>call HelpVimgrep(<span style='
color:#339966'>srchpat</span><span style='font-family:Arial;color:windowtext'>[</span>,<span
style='color:#339966'>MC</span><span
style='font-family:Arial;color:windowtext'>]</span>)</p>

<p class=DispTxt><span style='font-family:"Arial Black";
color:maroon'>VimgrepHelp</span>/<span style='
font-family:"Arial Black";color:maroon'>HelpVimgrep()</span> acts on files in <b>runtimepath doc</b> directories, so there
is no file argument.  Similarly, since
the files/locations are already defined, <span style='
font-family:"Arial Black";color:#339966'>FNonly</span>, <span style='font-family:"Arial Black";color:#339966'>terse</span>, <span
style='font-family:"Arial Black";color:#339966'>doSubs</span>, <span
style='font-family:"Arial Black";color:#339966'>fpat</span>, and <span
style='font-family:"Arial Black";color:#339966'>mpat</span> do no
apply.</p>

<p class=SyntaxStmt>call BufsVimgrep(<span style='
color:#339966'>srchpat</span><span style='font-family:Arial;color:windowtext'>[</span>,<span
style='color:#339966'>MC</span><span
style='font-family:Arial;color:windowtext'>]</span>)</p>

<p class=DispTxt><span style='font-family:"Arial Black";
color:maroon'>VimgrepBufs</span>/<span style='
font-family:"Arial Black";color:maroon'>BufsVimgrep()</span> address open buffers, so there
is no need for a <span style='font-family:"Arial Black";
color:#339966'>file</span> argument. 
Likewise, <span style='font-family:"Arial Black";
color:#339966'>FNonly</span>, <span style='
font-family:"Arial Black";color:#339966'>terse</span>, <span style='font-family:"Arial Black";color:#339966'>doSubs</span>, <span
style='font-family:"Arial Black";color:#339966'>fpat</span>, and <span
style='font-family:"Arial Black";color:#339966'>mpat</span> again
are not applicable.</p>

<p class=SyntaxStmt>call BufsToBufVimgrep(<span style='
color:#339966'>srchpat</span><span style='font-family:Arial;color:windowtext'>[</span>,<span
style='color:#339966'>MC</span><span
style='font-family:Arial;color:windowtext'>]</span>)</p>

<p class=DispTxt><span style='font-family:"Arial Black";
color:maroon'>VimgrepBufsToBuf</span>/<span style='
font-family:"Arial Black";color:maroon'>BufsToBufVimgrep()</span> address open buffers in
the same way as VimgrepBufs/BufsVimgrep(). 
The difference is that the output goes to a buffer for perusal instead
of being displayed on the command line or being returned as a argument.</p>

<span style='font-size:10.0pt;font-family:Arial;'><br
clear=all style='page-break-before:always'>
</span>

<p class=DispTxt>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>So, to recap, we have 2 commands that take no arguments, 3
commands/functions that take 2 required arguments and 6 optional (positional)
arguments, and 3 commands that take 1 required and 1 optional argument.</p>

<p class=DispTxt>Following is a brief description of the use of each
command/function:</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>Vimgrep</p>

<p class=CmdDesc>Vimgrep()               <span
style='color:#3366FF'>Search files for instances of a string or regular
expression pattern.</span></p>

<p class=CmdDesc><span style='color:#3366FF'>&nbsp;</span></p>

<p class=AssignTxt>Example:                                </p>

<p class=CmdTxt>echo Vimgrep(<span style='color:#339966'>‘todo’,$VIMRUNTIME.’/indent/*.vim’,0,0,1</span>)</p>

<p class=AssignTxt>&nbsp;</p>

<p class=AssignTxt>Searches:                              <span
style='color:teal'>$VIMRUNTIME/indent/*.vim files, ignoring case (MC=0), not
returning just file names (FNonly=0), and not returning messages on non-matches
(terse=1), for instances of ‘todo’ and echoing the return to the command line.</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=CopyNPasteLabel style='margin-left:0in;text-indent:0in'>Copy'n'paste<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Note that quote characters may not paste properly</p>

<p class=CopyNPaste>echo Vimgrep(‘todo’,$VIMRUNTIME.’/indent/*.vim’,0,0,1)</p>

<p class=AssignTxt><span style='color:#3366FF'>&nbsp;</span></p>

<p class=AssignTxt>Example:                                </p>

<p class=CmdTxt>let <span style='color:#339966'>traps</span>=</p>

<p class=CmdTxt>\Vimgrep(‘\&lt;try\&gt;\|\&lt;catch\&gt;\|\&lt;endtry\&gt;’,$VIMRUNTIME,1,0,1,1,’\w*\.vim\&gt;’,’syntax\|lang’)</p>

<p class=AssignTxt>&nbsp;</p>

<p class=AssignTxt>Searches:                              <span
style='color:teal'>$VIMRUNTIME, matching case (MC=1), not returning just file
names (FNonly=0), not returning messages on non-matches (terse=1),  and searching in subdirectories (doSubs=1)
in *.vim files but not files whose paths contain ‘syntax’ or ‘lang’, for
instances of the complete words ‘try’, ‘catch’, and ‘endtry’.  Results are assigned to the variable</span> <span
style='color:#339966'>traps</span>.</p>

<p class=DispTxt>&nbsp;</p>

<p class=CopyNPasteLabel style='margin-left:0in;text-indent:0in'>Copy'n'paste<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Note that quote characters may not paste properly</p>

<p class=CopyNPaste>let
traps=Vimgrep(‘\&lt;try\&gt;\|\&lt;catch\&gt;\|\&lt;endtry\&gt;’,$VIMRUNTIME,1,0,1,1,’\w*\.vim\&gt;’,’syntax\|lang’)</p>

<p class=AssignTxt>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><b><u>Note</u></b> the
difference here between searching a directory for <b>‘*.vim’</b> files (<span style='font-family:
"Arial Black";
color:#339966'>file</span> argument) and recursing a directory hierarchy and
matching a file pattern <b>‘\w*\.vim\&gt;’</b>
(<span style='font-family:"Arial Black";color:#339966'>fpat</span>
argument).  The former expands to a list
of files in a directory, while the latter sorts through a hierarchy comparing a
pattern to each file.</p>

<p class=DispTxt>&nbsp;</p>

<span style='font-size:10.0pt;font-family:"Arial Black";
color:purple;'><br clear=all style='page-break-before:always'>
</span>

<p class=AssignTxt>Example:                                </p>

<p class=CmdTxt>let <span style='color:#339966'>@z</span>=Vimgrep(<span
style='color:#339966'>‘</span><b><i><span style='color:#CC99FF'>{func-name}</span></i></b><span
style='color:#339966'>’,’../ftplugin/*.vim’</span>)</p>

<p class=AssignTxt>&nbsp;</p>

<p class=AssignDesc><span style='color:purple'>Searches:</span>                             the .vim files in
the ftplugin parallel directory to the current buffer file’s directory for the <b><i><span
style='color:#CC99FF'>{func-name}</span></i></b>and places the
result in the z register.</p>

<p class=DispTxt style='margin-left:0in'>&nbsp;</p>

<p class=AssignTxt>&nbsp;</p>

<p class=AssignTxt>Example:</p>

<p class=CmdTxt>Vimgrep <span style='color:#339966'>^\s*\&lt;fu\%[nction]\&gt;\%[!]\s\+\p*</span><b><i><span
style='color:#CC99FF'>{func-name} </span></i></b><span style='color:#339966'>&amp;runtimepath
0 0 1 1 \w*\.vim\&gt; bitmaps\|doc\|keymap\|lang\|syntax\|tools\|tutor</span></p>

<p class=AssignTxt>&nbsp;</p>

<p class=AssignDesc><span style='color:purple'>Searches:</span>                             the .vim files in
the &amp;runtimepath option variable’s directories (minus some unlikely
locations) for the function definition of <b><i><span style='color:#CC99FF'>{func-name}</span></i></b>and
echoes it to the command line.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>This could be a useful private command, I use it!</p>

<p class=DispTxt>&nbsp;</p>

<p class=CopyNPasteLabel style='margin-left:0in;text-indent:0in'>Copy'n'paste<span
style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>&nbsp;</p>

<p class=CopyNPaste>command! -nargs=1 FindFunc Vimgrep ^\s*\&lt;fu\%[nction]\&gt;\%[!]\s\+\p*&lt;args&gt;
&amp;runtimepath 0 0 1 1 \w*\.vim\&gt;
bitmaps\|doc\|keymap\|lang\|syntax\|tools\|tutor</p>

<p class=CopyNPaste>command! -nargs=1 FindCmd Vimgrep
^\s*\&lt;com\%[mand]\&gt;\%[!]\s\+\p*&lt;args&gt; &amp;runtimepath 0 0 1 1
\w*\.vim\&gt; bitmaps\|doc\|keymap\|lang\|syntax\|tools\|tutor</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>The 2 above lines can be cut and pasted (be sure each is as
one continuous line).  Don’t mind the
red syntax coloring if you paste into a vim filetype (it will be at <span
style='font-family:"Courier New";color:white;background:red'>\.v</span><span
style='font-family:"Courier New"'>i<span style='color:white;background:red'>m\&gt;</span></span>),
this is a syntax anomaly, there’s nothing wrong with the command lines.  Using</p>

<p class=CmdTxt>&nbsp;</p>

<p class=CmdTxt>FindFunc <span style='color:#339966'>indent</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>will find all the indent functions in the runtime path.  While</p>

<p class=CmdTxt>&nbsp;</p>

<p class=CmdTxt>FindCmd <span style='color:#339966'>tohtml</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>will find the TOhtml command in vim63\plugin\tohtml.vim.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>You will also find this to be valid:</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdTxt>Vimgrep <span style='color:#339966'>endif
%</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>Which, on the face of it, doesn’t seem useful, since you can
search the current file from the command line. 
It is implemented for two reasons: 1) completeness,  2) to provide a reference point for
searching.  Consider:</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdTxt>Vimgrep <span style='color:#339966'>endif
% 0 0 0 0 \w*\.\(vim\|txt\)\&gt;</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>This searches for the pattern in all <b>.vim</b> and <b>.txt</b> files in
the current buffer’s directory.  Empty
quotes may also be used as well as <b>dot</b> (an unquoted period for the command, a
quoted one for the function).</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>VimgrepToBuf</p>

<p class=DescTxt align=left style='text-align:left'><span style='
color:maroon'>ToBufVimgrep()</span>    Search
files for instances of a string or regular expression pattern and open the
result in a buffer.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>Places result from <span style='
font-family:"Arial Black";color:maroon'>Vimgrep</span> into a buffer for ease of
examination.  Browser pops up in gvim to
allow naming of the result file.  In
vim, the name of the result file is requested on the command line.  Location of result file defaults to the
current buffer file’s directory.  Search
pattern is highlighted.</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>VimgrepEdit</p>

<p class=DescTxt align=left style='text-align:left'><span style='
color:maroon'>EditVimgrep()</span>        Search
files for instances of a string or regular expression pattern and open the
files containing successful matches in buffers.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>Open files that successfully match the specified pattern in
buffers for ease of examination and or editing.  Search pattern is highlighted in each buffer.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DescTxt align=left style='text-align:left'><span style='color:maroon'>VimgrepEditDel</span>     Delete buffers opened by
VimgrepEdit/EditVimgrep().</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>VimgrepBufs</p>

<p class=DescTxt align=left style='text-align:left'><span style='
color:maroon'>BufsVimgrep()</span>       Search
listed buffers for instances of a string or regular expression pattern.  Command displays results on the command
line, function returns them.</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>VimgrepBufsToBuf</p>

<p class=DescTxt align=left style='text-align:left'><span style='
color:maroon'>BufsToBufVimgrep()</span>          Search
listed buffers for instances of a string or regular expression pattern.  Result is displayed in a new buffer.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>As with <span style='font-family:
"Arial Black";
color:maroon'>VimgrepToBuf/ToBufVimgrep()</span>, result from <span
style='font-family:"Arial Black";color:maroon'>Vimgrep</span> is
placed into a buffer for ease of examination. 
Browser pops up in gvim to allow naming of the result file.  In vim, the name of the result file is
requested on the command line.  Location
of result file defaults to the current buffer file’s directory.  Search pattern is highlighted.</p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdDesc>VimgrepHelp</p>

<p class=DescTxt align=left style='text-align:left'><span style='
color:maroon'>HelpVimgrep()</span>       Search
help (doc) files for instances of a string or regular expression pattern and
open the files containing successful matches in buffers in help file format.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>Open help files that successfully match the specified pattern
in buffers for ease of examination. 
Options are set to provide help file format and operation.  Search pattern is highlighted in each
buffer.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DescTxt><span style='color:maroon'>VimgrepHelpDel</span>   Delete buffers opened by
VimgrepHelp/HelpVimgrep().</p>

<span style='font-size:10.0pt;font-family:Arial;'><br
clear=all style='page-break-before:always'>
</span>

<p class=DispTxt>&nbsp;</p>

<p class=HeaderSep>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=DispTxt>There are also global variables that may have values specified
to modify the behavior of <span style='font-family:
"Arial Black";
color:maroon'>Vimgrep</span>.  You can
set <b>default arguments</b>, <b>default file creation location</b>, <b>default file search locations</b>, and <b>default help file (doc) locations</b>.  You can also change the <b>default key mapping</b> and gvim <b>toolbar
icons</b> for <b>deletion of help/edit
buffers</b>.  The naming convention for <b>vimgrep.vim</b> global
variables is that they all begin with <span style='font-family:"Arial Black";
color:purple'>VG</span>.</p>

<p class=DispTxt>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=DescTxt>&nbsp;</p>

<p class=DescTxt>&nbsp;</p>

<p class=DescTxt>Optional Argument Default
Variables</p>

<p class=CmdTxt>&nbsp;</p>

<p class=AssignTxt>g:VGMCDflt                            <span
style='color:teal'>match case argument. 
Default value 0.</span></p>

<p class=AssignTxt>g:VGFNonlyDflt                     <span
style='color:teal'>return file names only argument.  Default value 0.</span></p>

<p class=AssignTxt>g:VGterseDflt                        <span
style='color:teal'>do not return messages argument.  Default value 0.</span></p>

<p class=AssignTxt>g:VGdoSubsDflt                    <span
style='color:teal'>recurse subdirectories argument.  Default value 0.</span></p>

<p class=AssignTxt>g:VGfpatDflt                          <span
style='color:teal'>file pattern argument. 
Default value ‘’.</span></p>

<p class=AssignTxt>g:VGmpatDflt                        <span
style='color:teal'>minus</span> <span style='color:teal'>file pattern
argument.  Default value ‘’.</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DescTxt>Creation Directory Default
Variable</p>

<p class=CmdTxt>&nbsp;</p>

<p class=AssignTxt>g:VGCreatDir                         <span
style='color:teal'>file creation directory default value.  Default value ‘~’.  Currently only used to create dummy file when </span><span
style='color:maroon'>Vimgrep</span><span
style='color:teal'> is invoked in an empty vim/gvim session.</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DescTxt>Not Qualified Path File
Directories Default Variable</p>

<p class=CmdTxt>&nbsp;</p>

<p class=AssignTxt>g:VGDirs                                 <span
style='color:teal'>search directories for file argument that is not a qualified
path.  Default is ‘~’, &amp;runtimepath,
getcwd().  When used, it is appended to
expand(“%:p:h”) and directories are search in the order specified.</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=DescTxt>Help (.txt) Files Parent
Directories Default Variable</p>

<p class=CmdTxt>&nbsp;</p>

<p class=AssignTxt>g:VGHlpDirs                           <span
style='color:teal'>search directories for help files ‘doc’ directory.  Default is ‘~’, &amp;runtimepath.  When used, ‘/doc/*.txt’ is appended to each
element in the list and expanded.</span></p>

<span style='font-size:10.0pt;font-family:Arial;'><br
clear=all style='page-break-before:always'>
</span>

<p class=DispTxt>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt><b>vimgrep.vim</b> adds
key mappings and menu selections with tool bar icons for the commands <span
style='font-family:"Arial Black";color:maroon'>VimgrepHelpDel</span>
and <span style='font-family:"Arial Black";color:maroon'>VimgrepEditDel</span>
to make these tasks simpler.  The menu
selections are placed under the ‘<b><u>U</u>ser
Specific</b>’ pull down menu, in a submenu named ‘<b><u>V</u>imgrep Buffers</b>’ with the two entries ‘<b>Delete <u>H</u>elp Buffers 
&lt;F6&gt;</b>’ and ‘<b>Delete <u>E</u>dit
Buffers  &lt;F7&gt;</b>’.  If you also have <b>curBuf.vim</b>, its entries are also in the pull down ‘<b><u>U</u>ser Specific</b>’, using key
mappings &lt;F8&gt;  and &lt;F9&gt;.</p>

<p class=DispTxt>&nbsp;</p>

<p class=DescTxt>Key Mappings and Tool Bar Icons
for Delete Help/Edit Buffers</p>

<p class=CmdTxt>&nbsp;</p>

<p class=AssignTxt>g: VGdelHlpmap                   <span
style='color:teal'>key mapping to </span><span style='color:maroon'>VimgrepHelpDel</span><span
style='color:teal'>.  Default value </span><span
style='color:#339966'>‘&lt;F6&gt;’</span><span
style='color:teal'>.</span></p>

<p class=AssignTxt>g: VGdelEdtmap                   <span
style='color:teal'>key mapping to</span> <span style='color:maroon'>VimgrepEditDel</span>.  <span style='color:teal'>Default value </span><span
style='color:#339966'>‘&lt;F7&gt;’</span>.</p>

<p class=AssignTxt>g:VGdelHlpIco                      <span
style='color:teal'>Tool Bar icon for </span><span style='color:maroon'>VimgrepHelpDel</span><span
style='color:teal'>.  Default value</span>
<span style='color:#339966'>tb_close</span><span
style='color:teal'>.</span></p>

<p class=AssignTxt>g:VGdelEdtIco                      <span
style='color:teal'>Tool Bar icon for </span><span style='color:maroon'>VimgrepEditDel</span><span
style='color:teal'>.  Default value</span>
<span style='color:#339966'>tb_close</span><span
style='color:teal'>.</span></p>

<p class=AssignTxt style='margin-left:0in;text-indent:0in'><span
style='color:teal'>&nbsp;</span></p>

<p class=DispTxt>The icon <span style='font-family:
"Arial Black";
color:#339966'>tb_close</span> is in the standard vim63 distribution as an X
pixmap file (.xpm).  <b>vimgrep_vim.zip</b> includes the .bmp
version as well.</p>

<p class=DispTxt>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DescTxt>Miscellaneous</p>

<p class=CmdTxt>&nbsp;</p>

<p class=AssignTxt>g: VGMSGLEVEL                   <span
style='color:teal'>Level of messages displayed by </span>vimgrep.vim<span
style='color:teal'> functions.  This is
a high water mark variable, that is, it sets the highest amount of messages
with lower numbers meaning more messages. 
There are 3 levels from normal to error.  Normal messages are operational information, these are level
0.  Warning messages warn of inability
to comply with requests, these are level 1. 
Error messages are operations that cannot be or were not performed for
various reasons, these are level 2. 
This variable is set to 1 by default, warnings and errors.  You may set it to whatever you wish for all
sessions in your vimrc or set it on the fly with the </span><span
style='color:maroon'>VGMSGLVL</span><span style='color:teal'> command</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=CmdTxt>VGMSGLVL <span style='color:#339966'>lvl</span></p>

<p class=DispTxt>&nbsp;</p>

<p class=AssignTxt>g: VGMSGPAUSE                   <span
style='color:teal'>By default, </span>vimgrep.vim<span style='color:teal'>
functions pause after issuing error messages to be sure they are seen, you can
eliminate this pause by setting this variable to 0.</span></p>

<span style='font-size:10.0pt;font-family:Arial;'><br
clear=all style='page-break-before:always'>
</span>

<p class=DispTxt style='margin-left:0in'>&nbsp;</p>

<p class=Divider>&nbsp;</p>

<p class=DispTxt>&nbsp;</p>

<p class=DispTxt>Besides <b>vimgrep.vim</b>,
the package consists of documents, a utility file, an extra buffer
source/execution file, gvim icon files, and a test suit file.  These are all packaged in zip format into a <b>vimfiles directory hierarchy</b>.  In the <b>plugin</b>
<b>directory</b> are <b>vimgrep.vim</b>, <b>vsutil.vim</b>, and <b>curBuf.vim</b>.  The <b>doc
directory</b> contains files in various formats for <b>vimgrep.vim</b> and <b>vsutil.vim</b>.  The <b>bitmaps directory</b> has the <b>xpm</b>
and <b>bmp</b> files for <b>vimgrep.vim</b> and <b>curBuf.vim</b>.  In <b>test</b>, the <b>testVG.vim</b> file
has commands for running tests on <b>Vimgrep</b> functionality, these also
serve as examples of usage.</p>

<p class=DispTxt>&nbsp;</p>

<p class=HeaderSep>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=DispTxt style='margin-left:0in'>&nbsp;</p>

</div>

</body>

</html>
